{"version":3,"sources":["uni-app:///main.js","webpack:///C:/Users/Rodman/project/weimai-wetapp-master/xiaomao_uni/pages/cinema/index.vue?5c30","webpack:///C:/Users/Rodman/project/weimai-wetapp-master/xiaomao_uni/pages/cinema/index.vue?958a","webpack:///C:/Users/Rodman/project/weimai-wetapp-master/xiaomao_uni/pages/cinema/index.vue?87c6","webpack:///C:/Users/Rodman/project/weimai-wetapp-master/xiaomao_uni/pages/cinema/index.vue?41a9","uni-app:///pages/cinema/index.vue","webpack:///C:/Users/Rodman/project/weimai-wetapp-master/xiaomao_uni/pages/cinema/index.vue?4532","webpack:///C:/Users/Rodman/project/weimai-wetapp-master/xiaomao_uni/pages/cinema/index.vue?af32"],"names":["wx","__webpack_require_UNI_MP_PLUGIN__","__webpack_require__","createPage","Page","components","filterNav","data","title","city","params","pageNum","limit","hallType","brandId","serviceId","selectRegion","hasMore","cinemas","cityCinemaInfo","isShow","nothing","noSchedule","onLoad","that","onReady","uni","onReachBottom","onShow","app","methods","getFilter","url","method","success","console","getCinemas","header","selectCity","resolve","_this","cityInit","changeCondition","obj","toggleShow"],"mappings":";;;;;;;;;;;;;AAAA;AAGA;AACA;AAHA;AACAA,EAAE,CAACC,iCAAiC,GAAGC,mBAAmB;AAG1DC,UAAU,CAACC,cAAI,CAAC,C;;;;;;;;;;;;;ACLhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAkH;AAClH;AACyD;AACL;AACa;;;AAGjE;AACkL;AAClL,gBAAgB,yLAAU;AAC1B,EAAE,2EAAM;AACR,EAAE,gFAAM;AACR,EAAE,yFAAe;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE,oFAAU;AACZ;AACA;;AAEA;AACe,gF;;;;;;;;;;;;ACvBf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA,aAAa,oMAEN;AACP,KAAK;AACL;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;AC1CA;AAAA;AAAA;AAAA;AAA6qB,CAAgB,2qBAAG,EAAC,C;;;;;;;;;;;;;;;;;;;;;;;;;;;ACuDjsB;AACA;AAAA,eACA;EACAC;IACAC;EACA;EACA;EACAC;IACA;MACAC;MACAC;MACAC;QACA;QACAC;QACAC;QACAC;QACAC;QACAC;QACAC;MACA;MACAC;MACAC;MACA;MACAC;MACA;MACAC;MACA;MACAC;MACA;MACAC;IACA;EACA;;EACAC;IACA;IACAC;IACAA;IACAA;EACA;EACAC;IACAC;MACAlB;IACA;EACA;EACA;EACAmB;IACA;MACA;IACA;IACA;EACA;EACAC;IACA;MACA;QACAnB;MACA;IACA;MACA;QACAA;MACA;IACA;IACA;MACAoB;MACA;QACAnB,wCACA;UACAC;QAAA,EACA;QACAF;QACAS;QACAG;MACA;MACA;MACA;IACA;EACA;EACAS;IACAC;MACA;MACAL;QACAM;QACAC;QACA1B;QACA2B;UACAC;UACAX;YACAL;UACA;QACA;MACA;IACA;IAEAiB;MACA;MACA;MACA;QACAV;UACAM;UACAC;UACAI;YACA;UACA;UACA9B,sCACAG;YACAC;YACA2B;UAAA,EACA;UACAJ;YACAC;YACAT;YACAa;YACA;cACAC;gBACAlB;gBACAL;cACA;cACA;YACA;YACAuB;cACAvB;cACAC;cACAR,wCACA8B;gBACA7B;cAAA;YAEA;UACA;QACA;MACA;IACA;IAEA8B;MAAA;MACA;QACA;UACAhC;QACA;MACA;QACAoB;UACA;YACApB;UACA;QACA;MACA;IACA;IAEAiC;MAAA;MACA;MACAhB;QACAlB;MACA;MACA,aACA;QACAE,sDACA,cACAiC;UACAhC;QAAA,EACA;QACAO;QACAG;MACA,GACA;QACA;UACA;YACA;cACAA;YACA;UACA;UACAK;QACA;MACA,EACA;IACA;IAEA;IACAkB;MACA;MACA;QACAxB;MACA;IACA;EACA;AACA;AAAA,2B;;;;;;;;;;;;;AC3OA;AAAA;AAAA;AAAA;AAA89B,CAAgB,w7BAAG,EAAC,C;;;;;;;;;;;ACAl/B;AACA,OAAO,KAAU,EAAE,kBAKd","file":"pages/cinema/index.js","sourcesContent":["import 'uni-pages';\n// @ts-ignore\nwx.__webpack_require_UNI_MP_PLUGIN__ = __webpack_require__;\nimport Vue from 'vue'\nimport Page from './pages/cinema/index.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./index.vue?vue&type=template&id=7ef7f9a6&\"\nvar renderjs\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\nimport style0 from \"./index.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../application/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"pages/cinema/index.vue\"\nexport default component.exports","export * from \"-!../../../../../application/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../application/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--17-0!../../../../../application/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../../application/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../../application/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../application/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./index.vue?vue&type=template&id=7ef7f9a6&\"","var components\ntry {\n  components = {\n    filterNav: function () {\n      return import(\n        /* webpackChunkName: \"components/filter-nav/filter-nav\" */ \"@/components/filter-nav/filter-nav.vue\"\n      )\n    },\n  }\n} catch (e) {\n  if (\n    e.message.indexOf(\"Cannot find module\") !== -1 &&\n    e.message.indexOf(\".vue\") !== -1\n  ) {\n    console.error(e.message)\n    console.error(\"1. 排查组件名称拼写是否正确\")\n    console.error(\n      \"2. 排查组件是否符合 easycom 规范，文档：https://uniapp.dcloud.net.cn/collocation/pages?id=easycom\"\n    )\n    console.error(\n      \"3. 若组件不符合 easycom 规范，需手动引入，并在 components 中注册该组件\"\n    )\n  } else {\n    throw e\n  }\n}\nvar render = function () {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  var g0 = _vm.cinemas.length > 0 && _vm.hasMore\n  _vm.$mp.data = Object.assign(\n    {},\n    {\n      $root: {\n        g0: g0,\n      },\n    }\n  )\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../../../application/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../application/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--13-1!../../../../../application/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../application/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../application/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../application/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../application/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--13-1!../../../../../application/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../application/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../application/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./index.vue?vue&type=script&lang=js&\"","<template>\n    <!-- index.wxml -->\n\n    <view class=\"container\" :style=\"'position:' + (isShow ? 'fixed' : '')\">\n        <view class=\"topbar\">\n            <navigator class=\"city-entry\" url=\"../subPages/city-select/city-select\">\n                <text class=\"city-name\">{{ city }}</text>\n                <text class=\"city-entry-arrow\"></text>\n            </navigator>\n            <navigator url=\"../subPages/search-page/search-page?stype=2\" class=\"search\">\n                <text class=\"iconfont icon-sousuo\"></text>\n                搜影院\n            </navigator>\n        </view>\n        <view class=\"nav-wrapper\">\n            <filter-nav :city-cinema-info=\"cityCinemaInfo\" @change=\"changeCondition\" @toggleShow=\"toggleShow\"></filter-nav>\n        </view>\n        <view class=\"cinema-list\">\n            <block v-for=\"(item, index) in cinemas\" :key=\"index\">\n                <navigator class=\"cinema-section\" :url=\"'/pages/subPages/cinema-detail/cinema-detail?cinemaId=' + item.cinema.id\" hover-class=\"none\">\n                    <view class=\"flex item\">\n                        <view class=\"flex_auto item_left\">\n                            <view>\n                                <text class=\"title\">{{ item.cinema.nm }}</text>\n                            </view>\n                            <view>\n                                <text class=\"sub_title\">{{ item.cinema.addr }}</text>\n                            </view>\n                            <view class=\"tag\">\n\n                            </view>\n                        </view>\n                        <view class=\"item_right\" v-if=\"item.cinema.distance\">\n                            <view>\n                                <text class=\"price\">{{ item.cinema.distance }}km</text>\n                            </view>\n                        </view>\n                    </view>\n                </navigator>\n            </block>\n            <view v-if=\"cinemas.length > 0 && hasMore\">\n                <!-- parse <template is=\"loadingMore\"/> -->\n                <block name=\"loadingMore\">\n                    <view class=\"loadingMore\">\n                        <image src=\"/static/image/user/loading.gif\" class=\"loading-img\"></image>\n                        <view class=\"loading-text\">正在加载...</view>\n                    </view>\n                </block>\n            </view>\n        </view>\n    </view>\n</template>\n\n<script>\nimport filterNav from '@/components/filter-nav/filter-nav';\nconst util = require('../../utils/util.js');\nconst app = getApp();\nexport default {\n    components: {\n        filterNav\n    },\n    //事件处理函数\n    data() {\n        return {\n            title: '',\n            city: '正在定位...',\n            params: {\n                //url请求参数对象\n                pageNum: 0,\n                limit: 8,\n                hallType: -1,\n                brandId: -1,\n                serviceId: -1,\n                selectRegion: ''\n            },\n            hasMore: true,\n            cinemas: [],\n            //影院列表\n            cityCinemaInfo: {},\n            //城市影院信息\n            isShow: false,\n            //导航下拉框是否展开\n            nothing: false,\n            //是否有符合过滤的影院\n            noSchedule: false //当天是否有场次，原本时间是由后台返回的，但是缺少城市ID就没有返回，导致当天可能没有播放场次\n        };\n    },\n    onLoad: function (options) {\n        var that = this;\n        that.cityInit();\n        that.getFilter();\n        that.getCinemas(that.params);\n    },\n    onReady: function () {\n        uni.setNavigationBarTitle({\n            title: '电影院'\n        });\n    },\n    //上拉触底加载更多\n    onReachBottom() {\n        if (!this.hasMore) {\n            return;\n        }\n        this.getCinemas(this.params);\n    },\n    onShow: function () {\n        if (app.globalData.selectCity) {\n            this.setData({\n                city: app.globalData.selectCity.cityName\n            });\n        }else{\r\n\t\t\tthis.setData({\r\n\t\t\t    city: app.globalData.selectCity.cityName\r\n\t\t\t});\r\n\t\t}\n        if (app.globalData.isRefresh) {\n            app.globalData.isRefresh = false;\n            this.setData({\n                params: {\n                    ...this.params,\n                    pageNum: 0\n                },\n                city: app.globalData.selectCity.cityName,\n                cinemas: [],\n                nothing: false\n            });\n            this.getFilter();\n            this.getCinemas(this.params);\n        }\n    },\n    methods: {\n        getFilter() {\n            var that = this;\n            uni.request({\n                url: app.globalData.url + '/cinema/getFilters',\n                method: 'POST',\n                data: app.globalData.selectCity,\n                success: function (res) {\n                    console.log(res.data);\n                    that.setData({\n                        cityCinemaInfo: res.data\n                    });\n                }\n            });\n        },\n\n        getCinemas(params) {\n            const _this = this;\n            var pageIndex = _this.params.pageNum;\n            return new Promise((resolve, reject) => {\n                uni.request({\n                    url: app.globalData.url + `/cinema/getCinemas`,\n                    method: 'POST',\n                    header: {\n                        'content-type': 'application/x-www-form-urlencoded'\n                    },\n                    data: {\n                        ...params,\n                        pageNum: ++pageIndex,\n                        selectCity: JSON.stringify(app.globalData.selectCity)\n                    },\n                    success(res) {\r\n\t\t\t\t\t\tconsole.log(_this.params,JSON.stringify(app.globalData.selectCity));\n                        uni.hideLoading();\n                        resolve(res.data.data.beanList);\n                        if (!res.data.data.beanList.length) {\n                            _this.setData({\n                                noSchedule: true,\n                                hasMore: false\n                            });\n                            return;\n                        }\n                        _this.setData({\n                            hasMore: pageIndex < res.data.data.tr,\n                            cinemas: _this.cinemas.concat(res.data.data.beanList),\n                            params: {\n                                ..._this.params,\n                                pageNum: pageIndex\n                            }\n                        });\n                    }\n                });\n            });\n        },\n\n        cityInit: function () {\n            if (app.globalData.userLocation) {\n                this.setData({\n                    city: app.globalData.selectCity ? app.globalData.selectCity.cityName : '定位失败'\n                });\n            } else {\n                app.globalData.userLocationReadyCallback = () => {\n                    this.setData({\n                        city: app.globalData.selectCity ? app.globalData.selectCity.cityName : '定位失败'\n                    });\n                };\n            }\n        },\n\n        changeCondition(e) {\n            const obj = e.detail;\n            uni.showLoading({\n                title: '正在加载...'\n            });\n            this.setData(\n                {\n                    params: {\n                        ...this.params,\n                        ...obj,\n                        pageNum: 0\n                    },\n                    cinemas: [],\n                    nothing: false\n                },\n                () => {\n                    this.getCinemas(this.params).then((list) => {\n                        if (!list.length) {\n                            this.setData({\n                                nothing: true\n                            });\n                        }\n                        uni.hideLoading();\n                    });\n                }\n            );\n        },\n\n        //导航下拉框状态变化时的处理\n        toggleShow(e) {\n            const item = e.detail.item;\n            this.setData({\n                isShow: item !== -1\n            });\n        }\n    }\n};\n</script>\n<style>\n@import './index.css';\n@import '@/templates/loadingMore/loadingMore.css';\n</style>\n","import mod from \"-!../../../../../application/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../../application/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../../application/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../application/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--6-oneOf-1-2!../../../../../application/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-3!../../../../../application/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../application/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./index.vue?vue&type=style&index=0&lang=css&\"; export default mod; export * from \"-!../../../../../application/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../../application/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../../application/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../application/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--6-oneOf-1-2!../../../../../application/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-3!../../../../../application/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../application/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./index.vue?vue&type=style&index=0&lang=css&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1723696092488\n      var cssReload = require(\"C:/Users/Rodman/application/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"../../\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  "],"sourceRoot":""}