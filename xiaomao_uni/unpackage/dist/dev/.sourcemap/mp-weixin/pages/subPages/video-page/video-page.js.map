{"version":3,"sources":["uni-app:///main.js","webpack:///C:/Users/Rodman/project/weimai-wetapp-master/xiaomao_uni/pages/subPages/video-page/video-page.vue?f6e7","webpack:///C:/Users/Rodman/project/weimai-wetapp-master/xiaomao_uni/pages/subPages/video-page/video-page.vue?4cd4","webpack:///C:/Users/Rodman/project/weimai-wetapp-master/xiaomao_uni/pages/subPages/video-page/video-page.vue?d048","webpack:///C:/Users/Rodman/project/weimai-wetapp-master/xiaomao_uni/pages/subPages/video-page/video-page.vue?d0e4","uni-app:///pages/subPages/video-page/video-page.vue","webpack:///C:/Users/Rodman/project/weimai-wetapp-master/xiaomao_uni/pages/subPages/video-page/video-page.vue?eb10","webpack:///C:/Users/Rodman/project/weimai-wetapp-master/xiaomao_uni/pages/subPages/video-page/video-page.vue?6b00"],"names":["wx","__webpack_require_UNI_MP_PLUGIN__","__webpack_require__","createPage","Page","data","info","videoList","current","infoList","isWish","videourl","onLoad","methods","initData","uni","key","success","url","method","header","token","console","obj","videoImg","videoName","that","fail","setCurrent","movieName","id","version","detailMovie","release","rt","wish","globalReleased","sc","showst","cat","movieId","title","selectItem","endHandle","index","errorHandle","icon","goTo","VideoContext","wantToWatch","content","prevPage"],"mappings":";;;;;;;;;;;;;AAAA;AAGA;AACA;AAHA;AACAA,EAAE,CAACC,iCAAiC,GAAGC,mBAAmB;AAG1DC,UAAU,CAACC,kBAAI,CAAC,C;;;;;;;;;;;;;ACLhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAuH;AACvH;AAC8D;AACL;AACa;;;AAGtE;AACqL;AACrL,gBAAgB,yLAAU;AAC1B,EAAE,gFAAM;AACR,EAAE,qFAAM;AACR,EAAE,8FAAe;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE,yFAAU;AACZ;AACA;;AAEA;AACe,gF;;;;;;;;;;;;ACvBf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;ACnBA;AAAA;AAAA;AAAA;AAAisB,CAAgB,grBAAG,EAAC,C;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACsDrtB;AACA;AACA;AAAA,eACA;EACAC;IACA;MACAC;MACAC;MAEA;MACAC;MAEA;MACAC;MAEAC;MACAC;IACA;EACA;EACAC;IACA;IACA;EACA;EACAC;IACAC;MACA;MACA;MACA;MACA;MACAC;QACAC;QACAC;UACAF;YACAG;YACAC;YACAC;cACAC;YACA;YACAJ;cACAK;cACA;cACA,mCAEAC,WAEA;cACA;gBACAhB;kBACAI;kBACAa;kBACAC;gBACA;cACA;cACA;cACAC,aACA;gBACAnB;gBACAD;gBACAG;cACA,GACA;gBACAiB;cACA,EACA;YACA;UACA;QACA;QACAC;UACAZ;YACAG;YACAC;YACAF;cACAK;cACA;cACA,mCAEAC,WAEA;cACA;gBACAhB;kBACAI;kBACAa;kBACAC;gBACA;cACA;cACA;cACAC,aACA;gBACAnB;gBACAD;gBACAG;cACA,GACA;gBACAiB;cACA,EACA;YACA;UACA;QACA;MACA;IACA;IAEA;IACAE;MACA;QAAArB;MACA;QACA;QACAD;UACAuB;UACA;UACAC;UACA;UACAC,SACAC,uBACAA;YACA;UACA;UACA;UACAC;UACA;UACAC;UACA;UACAC;UACA;UACAC;UACA;UACAC;UACA;UACAC;UACA;UACAC;QACA;MACA;MACA;QACA;QACAxB;UACAC;UACAC;YACAF;cACAG;cACAC;cACAC;gBACAC;cACA;cACAhB;gBACAmC;cACA;cACAvB;gBACAS;kBACAhB;gBACA;cACA;YACA;UACA;QACA;MACA;MACAK;QACA0B;MACA;MACA;QACAnC;QACAE;MACA;IACA;IAEA;IACAkC;MACA;MACA;QACA;MACA;IACA;IAEA;IACAC;MACA;QAAApC;MACA;MACA;QACAqC;MACA;MACA;IACA;IAEA;IACAC;MACA9B;QACA0B;QACAK;MACA;IACA;IAEA;IACAC;MACA;MACA;MACAC;MACAjC;QACAG;MACA;IACA;IAEA;IACA+B;MACA;MACAlC;QACAC;QACAC;UACAK;UACAP;YACAG;YACAC;YACAC;cACA;cACAC;YACA;YACAhB;cACAmC;YACA;YACAvB;cACA;gBACAF;kBACAmC;kBACAjC;oBACAF;sBACAG;oBACA;kBACA;gBACA;cACA;gBACAQ;kBACAhB;gBACA;gBACA;gBACA;gBACA;gBACAyC;kBACAzC;gBACA;cACA;YACA;UACA;QACA;QACAiB;UACAZ;YACAmC;YACAjC;cACAF;gBACAG;cACA;YACA;UACA;QACA;MACA;IACA;EACA;AACA;AAAA,2B;;;;;;;;;;;;;ACtTA;AAAA;AAAA;AAAA;AAAw/B,CAAgB,67BAAG,EAAC,C;;;;;;;;;;;ACA5gC;AACA,OAAO,KAAU,EAAE,kBAKd","file":"pages/subPages/video-page/video-page.js","sourcesContent":["import 'uni-pages';\n// @ts-ignore\nwx.__webpack_require_UNI_MP_PLUGIN__ = __webpack_require__;\nimport Vue from 'vue'\nimport Page from './pages/subPages/video-page/video-page.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./video-page.vue?vue&type=template&id=6be2a91d&\"\nvar renderjs\nimport script from \"./video-page.vue?vue&type=script&lang=js&\"\nexport * from \"./video-page.vue?vue&type=script&lang=js&\"\nimport style0 from \"./video-page.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../application/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"pages/subPages/video-page/video-page.vue\"\nexport default component.exports","export * from \"-!../../../../../../application/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../../application/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--17-0!../../../../../../application/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../../../application/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../../../application/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../application/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./video-page.vue?vue&type=template&id=6be2a91d&\"","var components\nvar render = function () {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  var g0 = _vm.info && _vm.current !== -1 ? _vm.videoList.length : null\n  var g1 = _vm.info && _vm.current !== -1 && g0 ? _vm.videoList.length : null\n  _vm.$mp.data = Object.assign(\n    {},\n    {\n      $root: {\n        g0: g0,\n        g1: g1,\n      },\n    }\n  )\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../../../../application/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../application/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--13-1!../../../../../../application/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../application/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../application/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./video-page.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../../application/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../application/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--13-1!../../../../../../application/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../application/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../application/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./video-page.vue?vue&type=script&lang=js&\"","<template>\n    <view v-if=\"info && current !== -1\">\n        <view class=\"video-box\">\n            <!-- video是原生组件，有很多限制，如不能设置position: fixed；设置其父元素position也不行，所以下面用scroll-view。 -->\n            <video id=\"my-video\" :src=\"videoList[current].videourl\" autoplay @ended=\"endHandle\" @error=\"errorHandle\"></video>\n        </view>\n        <scroll-view class=\"my-scroll\" scroll-y>\n            <view class=\"movie-intro-desc\">\n                <view class=\"name-box\">\n                    <view class=\"name\">{{ info.movieName }}</view>\n                    <view class=\"tag-box\" v-if=\"info.version\">\n                        <text class=\"tag-d\">{{ info.version[0] }}</text>\n                        <text v-if=\"info.version[1]\" class=\"tag-imax\">{{ info.version[1] }}</text>\n                    </view>\n                </view>\n                <view class=\"sc-box\">\n                    <view v-if=\"info.globalReleased\" class=\"\">\n                        <view v-if=\"info.sc\">\n                            评分\n                            <text class=\"yellow\">{{ info.sc }}</text>\n                        </view>\n                        <view v-else>暂无评分</view>\n                    </view>\n                    <view v-else>\n                        <text class=\"yellow\">{{ info.wish }}</text>\n                        人想看\n                    </view>\n                </view>\n                <view class=\"release\">{{ info.release }} {{ info.rt }}</view>\n                <view class=\"buy-tickets\">\n                    <view v-if=\"info.showst === 3\" class=\"btn\" @tap=\"goTo\">购票</view>\n                    <view v-else-if=\"info.showst === 1\" :class=\"'btn ' + (isWish ? 'want-see' : '')\" @tap=\"wantToWatch\">\n                        <text v-if=\"isWish\">已想看</text>\n                        <text v-else>想看</text>\n                    </view>\n                    <view v-else-if=\"info.showst === 2\" class=\"btn pre-sale\" @tap=\"goTo\">预售</view>\n                </view>\n            </view>\n            <view class=\"list-box\" v-if=\"videoList.length\">\n                <view class=\"play-title\">播放列表 （{{ videoList.length }}）</view>\n                <view class=\"video-item\" @tap=\"selectItem\" :data-index=\"index\" v-for=\"(item, index) in videoList\" :key=\"index\">\n                    <view class=\"img-box\">\n                        <image :src=\"item.videoImg\" mode=\"aspectFill\"></image>\n                        <view class=\"txt\" v-if=\"current === index\">播放中</view>\n                    </view>\n\n                    <view :class=\"'video-name ' + (current === index ? 'red' : '')\">{{ item.videoName }}</view>\n                </view>\n            </view>\n        </scroll-view>\n    </view>\n</template>\n\n<script>\nconst util = require('../../../utils/util.js');\nconst getRandom = util.getRandom;\nconst app = getApp();\nexport default {\n    data() {\n        return {\n            info: null,\n            videoList: [],\n\n            //播放列表\n            current: -1,\n\n            //当前播放视频索引\n            infoList: [],\n\n            isWish: false,\n            videourl: ''\n        };\n    },\n    onLoad(opt) {\n        const paramsObj = JSON.parse(opt.paramsStr);\n        this.initData(paramsObj);\n    },\n    methods: {\n        initData(obj) {\n            //没有获取video列表的API，所以只能自己模拟一个播放列表\n            // const random = getRandom(1, 4)\n            //const videoList = new Array(random).fill(obj.video)\n            var that = this;\n            uni.getStorage({\n                key: 'userInfo',\n                success: function (res1) {\n                    uni.request({\n                        url: app.globalData.url + `/home/getLikeMovieList?movieId=${obj.id}&cat=${obj.cat}`,\n                        method: 'GET',\n                        header: {\n                            token: res1.data.data.token\n                        },\n                        success(res) {\n                            console.log(res);\n                            var likeVideos = res.data.data;\n                            const videoList = [\n                                {\n                                    ...obj.video\n                                }\n                            ];\n                            for (var i in likeVideos) {\n                                videoList.push({\n                                    videourl: likeVideos[i].videoUrl,\n                                    videoImg: likeVideos[i].videoImg,\n                                    videoName: likeVideos[i].videoName\n                                });\n                            }\n                            // likeVideos.unshift(obj);\n                            that.setData(\n                                {\n                                    videoList,\n                                    info: obj,\n                                    infoList: likeVideos\n                                },\n                                () => {\n                                    that.setCurrent(0);\n                                }\n                            );\n                        }\n                    });\n                },\n                fail: function (res1) {\n                    uni.request({\n                        url: app.globalData.url + `/home/getLikeMovieList?movieId=${obj.id}&cat=${obj.cat}`,\n                        method: 'GET',\n                        success(res) {\n                            console.log(res);\n                            var likeVideos = res.data.data;\n                            const videoList = [\n                                {\n                                    ...obj.video\n                                }\n                            ];\n                            for (var i in likeVideos) {\n                                videoList.push({\n                                    videourl: likeVideos[i].videoUrl,\n                                    videoImg: likeVideos[i].videoImg,\n                                    videoName: likeVideos[i].videoName\n                                });\n                            }\n                            // likeVideos.unshift(obj);\n                            that.setData(\n                                {\n                                    videoList,\n                                    info: obj,\n                                    infoList: likeVideos\n                                },\n                                () => {\n                                    that.setCurrent(0);\n                                }\n                            );\n                        }\n                    });\n                }\n            });\n        },\n\n        //设置当前播放视频\n        setCurrent(current) {\n            var { info, videoList } = this;\n            if (current > 0) {\n                const detailMovie = this.infoList[current - 1];\n                info = {\n                    movieName: detailMovie.nm,\n                    //电影名称\n                    id: detailMovie.id,\n                    //电影ID\n                    version:\n                        detailMovie.version &&\n                        detailMovie.version.split(' ').map((item) => {\n                            return item.toUpperCase().replace('V', '');\n                        }),\n                    //电影类型（3d、IMAX）\n                    release: detailMovie.src,\n                    //上映时间\n                    rt: detailMovie.rt,\n                    //电影上映时间\n                    wish: detailMovie.wish,\n                    //想看的人数\n                    globalReleased: detailMovie.globalreleased,\n                    //是否上映\n                    sc: detailMovie.sc,\n                    //评分\n                    showst: detailMovie.showst,\n                    //判读“想看”、“预售”\n                    cat: detailMovie.cat\n                };\n            }\n            if (info.showst == 1) {\n                var that = this;\n                uni.getStorage({\n                    key: 'userInfo',\n                    success: function (res1) {\n                        uni.request({\n                            url: app.globalData.url + '/home/getIsWish',\n                            method: 'GET',\n                            header: {\n                                token: res1.data.data.token\n                            },\n                            data: {\n                                movieId: info.id\n                            },\n                            success: function (res) {\n                                that.setData({\n                                    isWish: res.data.data\n                                });\n                            }\n                        });\n                    }\n                });\n            }\n            uni.setNavigationBarTitle({\n                title: `${info.movieName} ${videoList[current].videoName}`\n            });\n            this.setData({\n                info,\n                current\n            });\n        },\n\n        //播放列表的点击事件\n        selectItem(e) {\n            const index = e.currentTarget.dataset.index;\n            if (index !== this.current) {\n                this.setCurrent(index);\n            }\n        },\n\n        //视频播放结束\n        endHandle() {\n            const { current, videoList } = this;\n            let index = current + 1;\n            if (index === videoList.length) {\n                index = 0;\n            }\n            this.setCurrent(index);\n        },\n\n        //播放错误时\n        errorHandle() {\n            uni.showToast({\n                title: '播放错误',\n                icon: 'none'\n            });\n        },\n\n        //购票\n        goTo() {\n            const info = this.info;\n            const VideoContext = uni.createVideoContext('my-video', this);\n            VideoContext.pause();\n            uni.navigateTo({\n                url: `../select-cinema/select-cinema?movieId=${info.id}&movieName=${info.movieName}&showTime=${info.rt}`\n            });\n        },\n\n        //想看\n        wantToWatch: function () {\n            var that = this;\n            uni.getStorage({\n                key: 'userInfo',\n                success: function (res1) {\n                    console.log(res1.data.data.token);\n                    uni.request({\n                        url: app.globalData.url + '/home/updateWish',\n                        method: 'POST',\n                        header: {\n                            'content-type': 'application/x-www-form-urlencoded',\n                            token: res1.data.data.token\n                        },\n                        data: {\n                            movieId: that.movieId\n                        },\n                        success: function (res) {\n                            if (res.data.state == 202) {\n                                uni.showModal({\n                                    content: '您还未登录',\n                                    success(res) {\n                                        uni.switchTab({\n                                            url: '/pages/user/user'\n                                        });\n                                    }\n                                });\n                            } else {\n                                that.setData({\n                                    isWish: !that.isWish\n                                });\n                                var pages = getCurrentPages();\n                                var prevPage = pages[pages.length - 2]; //上一个页面\n                                var isWish = prevPage.data.isWish;\n                                prevPage.setData({\n                                    isWish: !isWish\n                                });\n                            }\n                        }\n                    });\n                },\n                fail: function (res1) {\n                    uni.showModal({\n                        content: '您还未登录',\n                        success(res) {\n                            uni.switchTab({\n                                url: '/pages/user/user'\n                            });\n                        }\n                    });\n                }\n            });\n        }\n    }\n};\n</script>\n<style>\n@import './video-page.css';\n</style>\n","import mod from \"-!../../../../../../application/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../../../application/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../../../application/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../application/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--6-oneOf-1-2!../../../../../../application/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-3!../../../../../../application/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../application/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./video-page.vue?vue&type=style&index=0&lang=css&\"; export default mod; export * from \"-!../../../../../../application/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../../../application/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../../../application/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../application/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--6-oneOf-1-2!../../../../../../application/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-3!../../../../../../application/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../application/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./video-page.vue?vue&type=style&index=0&lang=css&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1723696092497\n      var cssReload = require(\"C:/Users/Rodman/application/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"../../\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  "],"sourceRoot":""}